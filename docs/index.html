<!doctype html>
<html lang="ja">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />

  <title>Image â†’ STL Relief Generator (Backlight Panel)</title>

  <meta name="description" content="Generate a relief STL for backlit panels from an image. Runs 100% in your browser. No upload, no server." />
  <meta name="theme-color" content="#111111" />

  <meta property="og:title" content="Image â†’ STL Relief Generator" />
  <meta property="og:description" content="Backlit relief panel STL generator. 100% client-side (no upload)." />
  <meta property="og:type" content="website" />

  <style>
    body{font-family:system-ui, -apple-system, Segoe UI, Roboto, sans-serif; margin:20px; max-width:980px}
    .row{display:flex; gap:18px; flex-wrap:wrap}
    .card{border:1px solid #ddd; border-radius:10px; padding:14px; flex:1; min-width:280px}
    label{display:block; margin:10px 0 6px}
    input[type="number"]{width:120px}
    canvas{border:1px solid #ddd; border-radius:10px; max-width:100%}
    button{padding:10px 14px; border-radius:10px; border:1px solid #333; background:#111; color:#fff; cursor:pointer}
    button:disabled{opacity:.5; cursor:not-allowed}
    .small{color:#555; font-size:12px}
    .mono{font-family:ui-monospace, SFMono-Regular, Menlo, Consolas, monospace}
    .pill{display:inline-block; padding:2px 8px; border-radius:999px; border:1px solid #ddd; font-size:12px; color:#333; margin-left:6px}
    .muted{color:#666}
    .k{font-weight:600}
    .note{background:#fafafa; border:1px solid #eee; padding:10px 12px; border-radius:10px}
  </style>
</head>

<body>
  <h1>
    Image â†’ STL Relief Generator
    <span class="pill">Backlight Panel</span>
    <span class="pill">Client-side</span>
  </h1>

  <p class="small">
    ç”»åƒã‚’ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã™ã‚‹ã¨ã€èƒŒé¢ç…§æ˜å‘ã‘ã®ã€Œåšã¿ãƒªãƒªãƒ¼ãƒ•ã€STLã‚’ç”Ÿæˆã—ã¦ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã§ãã¾ã™ã€‚<br>
    <span class="k">å‡¦ç†ã¯ã™ã¹ã¦ãƒ–ãƒ©ã‚¦ã‚¶å†…ã§å®Œçµ</span>ã—ã¾ã™ï¼ˆã‚µãƒ¼ãƒã¸ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã—ã¾ã›ã‚“ï¼‰ã€‚
  </p>

  <div class="note small">
    <div>âœ… Output: <span class="mono">.stl</span></div>
    <div>ğŸ–¼ Preview: æ­£è¦åŒ–ã—ãŸåšã¿ï¼ˆ8bitè¡¨ç¤ºï¼‰</div>
    <div class="muted">â€» Bright=Thinï¼ˆæ˜ã‚‹ã„ã»ã©è–„ã„ï¼‰ãŒæ¨™æº–ã§ã™ã€‚å¿…è¦ãªã‚‰ Invert ã‚’OFFã«ã§ãã¾ã™ã€‚</div>
  </div>

  <div class="row" style="margin-top:14px;">
    <div class="card">
      <h2>1) Input</h2>

      <label>Image file</label>
      <input id="file" type="file" accept="image/*" />

      <div id="dropzone" style="
        margin-top:10px;
        padding:16px;
        border:2px dashed #888;
        border-radius:12px;
        text-align:center;
        user-select:none;
      ">
        ã“ã“ã«ç”»åƒã‚’ãƒ‰ãƒ©ãƒƒã‚°ï¼†ãƒ‰ãƒ­ãƒƒãƒ—<br>
        <span class="small">ï¼ˆã¾ãŸã¯ä¸Šã® File ã§é¸æŠï¼‰</span>
      </div>

      <label>Physical width (mm)</label>
      <input id="widthMm" type="number" value="100" step="1" />

      <label>Processing width (px)</label>
      <input id="widthPx" type="number" value="600" step="10" />
      <div class="small muted">å¤§ãã„ã»ã©ãƒ‡ã‚£ãƒ†ãƒ¼ãƒ«ã¯å‡ºã¾ã™ãŒã€ç”ŸæˆãŒé‡ããªã‚Šã¾ã™ã€‚</div>

      <label>Base thickness (mm)</label>
      <input id="baseMm" type="number" value="0.8" step="0.1" />

      <label>Relief height (mm)</label>
      <input id="reliefMm" type="number" value="1.5" step="0.1" />

      <label>Black cut / White cut</label>
      <input id="blackCut" type="number" value="0.02" step="0.01" />
      <input id="whiteCut" type="number" value="0.98" step="0.01" />
      <div class="small muted">é»’ã¤ã¶ã‚Œãƒ»ç™½é£›ã³ã®èª¿æ•´ï¼ˆè¼åº¦ã‚¯ãƒªãƒƒãƒ—ï¼‰ã§ã™ã€‚</div>

      <label>Tone gamma (1.0 = linear)</label>
      <input id="toneGamma" type="number" value="1.15" step="0.01" />
      <div class="small muted">é€éã®è¦‹ãˆæ–¹ã‚’å°‘ã—æŒã¡ä¸Šã’ãŸã„æ™‚ã«ä½¿ã„ã¾ã™ã€‚</div>

      <label>Mapping</label>
      <label><input id="invert" type="checkbox" checked /> Invert (Bright=Thin) â€»æ¨™æº–</label>

      <label>Orientation</label>
      <label><input id="flipX" type="checkbox" /> flip-xï¼ˆå·¦å³åè»¢ï¼‰</label>
      <label><input id="flipY" type="checkbox" /> flip-yï¼ˆä¸Šä¸‹åè»¢ï¼‰</label>
      <label><input id="rot180" type="checkbox" /> rot180ï¼ˆ180Â°å›è»¢ = flip-x + flip-yï¼‰</label>

      <div style="margin-top:12px; display:flex; gap:10px; align-items:center;">
        <button id="btn" disabled>Generate & Download STL</button>
        <span id="status" class="small"></span>
      </div>

      <p class="small mono" id="outname"></p>
    </div>

    <div class="card">
      <h2>2) Preview</h2>
      <div class="small muted" style="margin-bottom:8px;">
        æ­£è¦åŒ–ã—ãŸåšã¿ã‚’è¡¨ç¤ºã—ã¾ã™ï¼ˆãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ã¯8bitè¡¨ç¤ºï¼‰ã€‚STLã¯å†…éƒ¨floatè¨ˆç®—çµæœã‹ã‚‰ç”Ÿæˆã•ã‚Œã¾ã™ã€‚
      </div>
      <canvas id="preview" width="600" height="400"></canvas>

      <div class="small muted" style="margin-top:10px;">
        ãƒ’ãƒ³ãƒˆï¼šSTLã¨ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ã®å‘ããŒåˆã‚ãªã„å ´åˆã¯ã€Orientationï¼ˆflip/rotï¼‰ã§åˆã‚ã›ã¦ãã ã•ã„ã€‚
      </div>
    </div>
  </div>

  <script src="./app.js"></script>
</body>
</html>
